# AlgorithmTrader

[![CI](https://github.com/ziho/AlgorithmTrader/actions/workflows/ci.yml/badge.svg)](https://github.com/ziho/AlgorithmTrader/actions/workflows/ci.yml)
[![Python 3.11+](https://img.shields.io/badge/python-3.11+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

ä¸€ä¸ªç°ä»£åŒ–çš„ä¸ªäººé‡åŒ–äº¤æ˜“ç³»ç»Ÿï¼Œä¸“æ³¨äºä¸­ä½é¢‘ç­–ç•¥ç ”å‘ä¸è‡ªåŠ¨åŒ–æ‰§è¡Œã€‚

## ç‰¹æ€§

- **ç»Ÿä¸€æ¶æ„**: ç ”ç©¶ã€å›æµ‹ã€å®ç›˜ä½¿ç”¨ç›¸åŒçš„ç­–ç•¥æ¥å£ï¼Œç¡®ä¿ç ”ç©¶ç»“æœçš„å¯å¤ç°æ€§
- **çµæ´»æ•°æ®å±‚**: å†å²æ•°æ®ç”¨ Parquet å­˜å‚¨ï¼Œå®æ—¶ç›‘æ§ç”¨ InfluxDBï¼Œå…¼é¡¾æ•ˆç‡ä¸æˆæœ¬
- **å†…ç½®ç­–ç•¥**: 5+ ç§ç»å…¸ç­–ç•¥å¼€ç®±å³ç”¨ï¼ˆåŒå‡çº¿ã€å¸ƒæ—å¸¦ã€RSIã€é€šé“çªç ´ç­‰ï¼‰
- **å®Œæ•´å·¥å…·é“¾**: æ•°æ®é‡‡é›†ã€å›æµ‹ã€å‚æ•°ä¼˜åŒ–ã€å®ç›˜æ‰§è¡Œã€ç›‘æ§å‘Šè­¦ä¸€ç«™å¼è§£å†³
- **å®¹å™¨åŒ–éƒ¨ç½²**: Docker Compose ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼Œé›†æˆ Grafana ç›‘æ§é¢æ¿
- **æ‰©å±•å‹å¥½**: æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œï¼Œä¾¿äºæ·»åŠ æ–°äº¤æ˜“æ‰€ã€æ–°ç­–ç•¥ã€æ–°å› å­

## æ”¯æŒçš„å¸‚åœº

| å¸‚åœº | èµ„äº§ç±»å‹ | çŠ¶æ€ |
|------|---------|------|
| åŠ å¯†è´§å¸ | ç°è´§ / æ°¸ç»­åˆçº¦ | âœ… å·²å®ç° |
| ç¾è‚¡ | æ­£è‚¡ / æœŸæƒ | ğŸš§ è§„åˆ’ä¸­ |
| Aè‚¡ | æ­£è‚¡ / æœŸæƒ | ğŸš§ è§„åˆ’ä¸­ |

**äº¤æ˜“æ‰€**: OKXï¼ˆå·²å®ç°ï¼‰ã€IBKRï¼ˆè§„åˆ’ä¸­ï¼‰

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Python 3.11+
- Docker & Docker Compose
- 64GB+ RAMï¼ˆæ¨èï¼‰

### å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/ziho/AlgorithmTrader.git
cd AlgorithmTrader

# å®‰è£…ä¾èµ–
pip install -e ".[dev]"

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env å¡«å…¥ä½ çš„ API å¯†é’¥å’Œé…ç½®
```

### å¯åŠ¨åŸºç¡€è®¾æ–½

```bash
# å¯åŠ¨ InfluxDB + Grafana
docker-compose up -d influxdb grafana

# è®¿é—® Grafana: http://localhost:3000
# é»˜è®¤è´¦å·: admin / algorithmtrader123
```

### æ•°æ®é‡‡é›†

```bash
# é‡‡é›†å†å²æ•°æ®
python scripts/demo_collect.py --symbol BTC/USDT --days 90

# å¯åŠ¨å®æ—¶é‡‡é›†æœåŠ¡
docker-compose up -d collector
```

### è¿è¡Œå›æµ‹

```bash
# è¿è¡Œç¤ºä¾‹å›æµ‹
python scripts/demo_backtest.py

# æŸ¥çœ‹å›æµ‹ç»“æœï¼ˆåœ¨ Grafana ä¸­æŸ¥çœ‹å›¾è¡¨ï¼‰
```

## æ¶æ„è®¾è®¡

### æ ¸å¿ƒç†å¿µ

1. **ç»Ÿä¸€æ¥å£**: ç­–ç•¥åªå…³å¿ƒ `on_bar()` å’Œ `on_fill()`ï¼Œç ”ç©¶/å›æµ‹/å®ç›˜æ— éœ€æ”¹ä»£ç 
2. **æ•°æ®åˆ†å±‚**: é‡‡é›† â†’ æ¸…æ´— â†’ ç‰¹å¾ â†’ ä¿¡å· â†’ æ‰§è¡Œï¼Œæ¯å±‚èŒè´£æ¸…æ™°
3. **å­˜å‚¨åˆ†å·¥**: 
   - InfluxDB: å®æ—¶æ•°æ®ã€ç›‘æ§æŒ‡æ ‡ã€å‘Šè­¦
   - Parquet: å†å²æ•°æ®ã€å›æµ‹ã€ç‰¹å¾å·¥ç¨‹
4. **æ¾è€¦åˆæœåŠ¡**: å„æœåŠ¡é€šè¿‡æ•°æ®å­˜å‚¨å±‚äº¤äº’ï¼Œä¾¿äºç‹¬ç«‹æ‰©å±•

### é¡¹ç›®ç»“æ„

```
AlgorithmTrader/
â”œâ”€â”€ src/                    # æ ¸å¿ƒåº“ï¼ˆç ”ç©¶/å›æµ‹/å®ç›˜å…±äº«ï¼‰
â”‚   â”œâ”€â”€ core/               # åŸºç¡€è®¾æ–½ï¼ˆæ—¶é’Ÿã€äº‹ä»¶ã€é…ç½®ï¼‰
â”‚   â”œâ”€â”€ data/               # æ•°æ®å±‚ï¼ˆé‡‡é›†ã€å­˜å‚¨ã€è´¨é‡æ£€æµ‹ï¼‰
â”‚   â”œâ”€â”€ strategy/           # ç­–ç•¥æ¡†æ¶ä¸ç¤ºä¾‹ç­–ç•¥
â”‚   â”œâ”€â”€ backtest/           # å›æµ‹å¼•æ“
â”‚   â”œâ”€â”€ execution/          # è®¢å•æ‰§è¡Œä¸äº¤æ˜“æ‰€é€‚é…
â”‚   â”œâ”€â”€ portfolio/          # ç»„åˆç®¡ç†ä¸è´¦æˆ·æ ¸ç®—
â”‚   â”œâ”€â”€ risk/               # é£æ§å¼•æ“
â”‚   â”œâ”€â”€ features/           # å› å­åº“ä¸ç‰¹å¾å·¥ç¨‹
â”‚   â””â”€â”€ ops/                # è¿ç»´å·¥å…·ï¼ˆæ—¥å¿—ã€é€šçŸ¥ã€å¥åº·æ£€æŸ¥ï¼‰
â”‚
â”œâ”€â”€ services/               # å¾®æœåŠ¡ï¼ˆå®¹å™¨åŒ–éƒ¨ç½²ï¼‰
â”‚   â”œâ”€â”€ collector/          # æ•°æ®é‡‡é›†æœåŠ¡
â”‚   â”œâ”€â”€ trader/             # å®ç›˜äº¤æ˜“æœåŠ¡
â”‚   â”œâ”€â”€ scheduler/          # ä»»åŠ¡è°ƒåº¦æœåŠ¡
â”‚   â”œâ”€â”€ backtest_runner/    # æ‰¹é‡å›æµ‹æœåŠ¡
â”‚   â”œâ”€â”€ notifier/           # æ¶ˆæ¯é€šçŸ¥æœåŠ¡
â”‚   â””â”€â”€ web/                # Web ç®¡ç†ç•Œé¢
â”‚
â”œâ”€â”€ infra/                  # åŸºç¡€è®¾æ–½é…ç½®
â”‚   â”œâ”€â”€ grafana/            # ç›‘æ§é¢æ¿
â”‚   â”œâ”€â”€ influxdb/           # æ—¶åºæ•°æ®åº“
â”‚   â””â”€â”€ loki/               # æ—¥å¿—èšåˆ
â”‚
â”œâ”€â”€ research/               # ç ”ç©¶ç¯å¢ƒ
â”‚   â”œâ”€â”€ notebooks/          # Jupyter ç¬”è®°æœ¬
â”‚   â””â”€â”€ qlib/               # Qlib æ¡†æ¶é›†æˆ
â”‚
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â”‚   â”œâ”€â”€ guides/             # æ“ä½œæŒ‡å—
â”‚   â”œâ”€â”€ tutorials/          # æ•™ç¨‹
â”‚   â””â”€â”€ development/        # å¼€å‘æ–‡æ¡£
â”‚
â””â”€â”€ tests/                  # æµ‹è¯•å¥—ä»¶
    â”œâ”€â”€ unit/               # å•å…ƒæµ‹è¯•
    â””â”€â”€ integration/        # é›†æˆæµ‹è¯•
```

## å†…ç½®ç­–ç•¥

| ç­–ç•¥ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| åŒå‡çº¿äº¤å‰ | è¶‹åŠ¿è·Ÿè¸ª | å¿«çº¿ä¸Šç©¿æ…¢çº¿åšå¤šï¼Œæ­»å‰å¹³ä»“ |
| é€šé“çªç ´ | è¶‹åŠ¿è·Ÿè¸ª | çªç ´Næ—¥é«˜ç‚¹åšå¤šï¼Œè·Œç ´Næ—¥ä½ç‚¹å¹³ä»“ |
| å¸ƒæ—å¸¦ | å‡å€¼å›å½’ | ä»·æ ¼è§¦åŠä¸‹è½¨åšå¤šï¼Œä¸Šè½¨å¹³ä»“ |
| RSI | å‡å€¼å›å½’ | è¶…å–åšå¤šï¼Œè¶…ä¹°å¹³ä»“ |
| Z-Score | å‡å€¼å›å½’ | åŸºäºç»Ÿè®¡åç¦»åº¦çš„é…å¯¹äº¤æ˜“ |

æŸ¥çœ‹ [ç­–ç•¥å¼€å‘æŒ‡å—](docs/guides/strategy_development.md) äº†è§£å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰ç­–ç•¥ã€‚

## æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ | ç”¨é€” |
|------|---------|------|
| è¯­è¨€ | Python 3.11+ | å¿«é€Ÿå¼€å‘ä¸åŸå‹éªŒè¯ |
| æ•°æ®å­˜å‚¨ | InfluxDB + Parquet | å®æ—¶ç›‘æ§ + å†å²å›æµ‹ |
| äº¤æ˜“æ‰€æ¥å£ | ccxt | ç»Ÿä¸€çš„äº¤æ˜“æ‰€æŠ½è±¡å±‚ |
| å®¹å™¨åŒ– | Docker Compose | ä¸€é”®éƒ¨ç½²æ‰€æœ‰æœåŠ¡ |
| ç›‘æ§ | Grafana + Loki | å¯è§†åŒ–é¢æ¿ä¸æ—¥å¿—èšåˆ |
| é€šçŸ¥ | Telegram / Bark / Webhook | å¤šæ¸ é“æ¶ˆæ¯æ¨é€ |
| æµ‹è¯• | pytest | å•å…ƒæµ‹è¯•ä¸é›†æˆæµ‹è¯• |
| CI/CD | GitHub Actions | è‡ªåŠ¨åŒ–æµ‹è¯•ä¸éƒ¨ç½² |

## æ•°æ®æµ

```
OKX/äº¤æ˜“æ‰€ API
       â†“
   collector æœåŠ¡
       â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â†“             â†“
Parquet      InfluxDB
(å†å²)        (å®æ—¶)
    â†“             â†“
research    Grafana ç›‘æ§
å›æµ‹å¼•æ“          â†“
    â†“         å‘Šè­¦é€šçŸ¥
ç­–ç•¥ä¿¡å·
    â†“
trader æœåŠ¡
    â†“
è®¢å•æ‰§è¡Œ
```

## å¼€å‘è·¯çº¿

### Phase 1: æ ¸å¿ƒæ¡†æ¶ï¼ˆå·²å®Œæˆï¼‰
- [x] é¡¹ç›®ç»“æ„ä¸é…ç½®ç®¡ç†
- [x] æ•°æ®é‡‡é›†ä¸å­˜å‚¨
- [x] å›æµ‹å¼•æ“ï¼ˆå•ç­–ç•¥ + æ‰¹é‡ï¼‰
- [x] 5ç§å†…ç½®ç­–ç•¥
- [x] é£æ§å¼•æ“
- [x] é€šçŸ¥ç³»ç»Ÿ
- [x] ç‰¹å¾å¼•æ“

### Phase 2: Web ç®¡ç†ç•Œé¢ï¼ˆè¿›è¡Œä¸­ï¼‰
- [x] å›æµ‹ç»“æœå¯è§†åŒ–
- [x] ç­–ç•¥é…ç½®ç®¡ç†
- [x] æœåŠ¡çŠ¶æ€ç›‘æ§
- [x] å‚æ•°ä¼˜åŒ–æ¡†æ¶
- [ ] å®æ—¶æ•°æ®åˆ·æ–°
- [ ] ä»»åŠ¡è¿›åº¦å±•ç¤º

### Phase 3: å®ç›˜äº¤æ˜“ï¼ˆè¿›è¡Œä¸­ï¼‰
- [x] OKX ç°è´§/æ°¸ç»­ä¸‹å•
- [x] è®¢å•ç®¡ç†ä¸è¿½è¸ª
- [x] æ»‘ç‚¹ä¸æ‰‹ç»­è´¹æ¨¡å‹
- [ ] å®ç›˜é£æ§å®Œå–„
- [ ] å¼‚å¸¸æ¢å¤æœºåˆ¶

### Phase 4: é«˜çº§åŠŸèƒ½ï¼ˆè§„åˆ’ä¸­ï¼‰
- [ ] OKX æ°¸ç»­åˆçº¦
- [ ] Walk-forward ä¼˜åŒ–
- [ ] å¤šç­–ç•¥ç»„åˆç®¡ç†
- [ ] Qlib æ¡†æ¶é›†æˆ

### Phase 5: å…¶ä»–å¸‚åœºï¼ˆè¿œæœŸï¼‰
- [ ] IBKR æ¥å£ï¼ˆç¾è‚¡ï¼‰
- [ ] Aè‚¡æ•°æ®å¯¹æ¥
- [ ] æœŸæƒç­–ç•¥

æŸ¥çœ‹ [GitHub Projects](https://github.com/ziho/AlgorithmTrader/projects) äº†è§£è¯¦ç»†è¿›åº¦ã€‚

## æ–‡æ¡£

- [ç”¨æˆ·æŒ‡å—](docs/guides/user_guide.md) - ç³»ç»Ÿä½¿ç”¨å®Œæ•´æŒ‡å—
- [ç­–ç•¥å¼€å‘](docs/guides/strategy_development.md) - å¦‚ä½•ç¼–å†™è‡ªå®šä¹‰ç­–ç•¥
- [éƒ¨ç½²æŒ‡å—](docs/guides/deployment.md) - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- [API å‚è€ƒ](docs/api/README.md) - æ ¸å¿ƒ API æ–‡æ¡£
- [æ¶æ„è®¾è®¡](docs/development/architecture.md) - ç³»ç»Ÿæ¶æ„è¯¦è§£
- [**åŠŸèƒ½å®Œæˆåº¦**](docs/KNOWN_LIMITATIONS.md) - å„æ¨¡å—çŠ¶æ€ä¸å·²çŸ¥é™åˆ¶

## å¿«é€ŸéªŒè¯

è¿è¡ŒçƒŸé›¾æµ‹è¯•è„šæœ¬éªŒè¯æ ¸å¿ƒåŠŸèƒ½ï¼š

```bash
python scripts/smoke_test.py
```

## Walk-Forward éªŒè¯ï¼ˆé˜²è¿‡æ‹Ÿåˆï¼‰

ä½¿ç”¨æ–°å¢çš„éªŒè¯å™¨åœ¨æ»‘åŠ¨çª—å£ä¸Šä¼˜åŒ–å¹¶éªŒè¯ç­–ç•¥ï¼š

```python
from src.optimization.walk_forward import WalkForwardValidator, WalkForwardConfig
from src.optimization.objectives import MaximizeSharpe
from src.optimization.methods import GridSearch
from my_strategies import MyStrategy

config = WalkForwardConfig(train_period_days=180, test_period_days=30, n_splits=6)
validator = WalkForwardValidator(config)
result = validator.run(
    strategy_class=MyStrategy,
    data={"BTC-USDT": your_dataframe},  # DataFrame éœ€å« timestamp/open/high/low/close/volume
    param_space={"fast": {"min": 5, "max": 20, "step": 5}},
    objective=MaximizeSharpe(),
    search_method=GridSearch(),
    timeframe="15m",
)
print(result.is_robust, result.avg_test_sharpe)
```

## æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œå•å…ƒæµ‹è¯•
pytest tests/unit/

# è¿è¡Œé›†æˆæµ‹è¯•
pytest tests/integration/

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=src tests/
```

## è´¡çŒ®

è¿™æ˜¯ä¸€ä¸ªä¸ªäººé¡¹ç›®ï¼Œä¸»è¦ç”¨äºå­¦ä¹ å’Œå®éªŒã€‚æ¬¢è¿æ Issue è®¨è®ºæƒ³æ³•ï¼Œä½†ä¸ä¿è¯ä¼šæ¥å— PRã€‚

## è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE)

## å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ ä¸ç ”ç©¶ä½¿ç”¨ã€‚é‡åŒ–äº¤æ˜“å­˜åœ¨é£é™©ï¼Œä½¿ç”¨æœ¬ç³»ç»Ÿè¿›è¡Œå®ç›˜äº¤æ˜“é€ æˆçš„ä»»ä½•æŸå¤±ï¼Œä½œè€…ä¸æ‰¿æ‹…è´£ä»»ã€‚è¯·åœ¨å……åˆ†ç†è§£ç­–ç•¥é€»è¾‘å’Œé£é™©çš„å‰æä¸‹è°¨æ…ä½¿ç”¨ã€‚

## ç›¸å…³èµ„æº

- [ccxt æ–‡æ¡£](https://docs.ccxt.com/)
- [InfluxDB æ–‡æ¡£](https://docs.influxdata.com/)
- [Grafana æ–‡æ¡£](https://grafana.com/docs/)
- [Qlib æ¡†æ¶](https://github.com/microsoft/qlib)

---

**æ³¨æ„**: æœ¬ç³»ç»Ÿè®¾è®¡ç”¨äºä¸­ä½é¢‘äº¤æ˜“ï¼ˆ15åˆ†é’Ÿè‡³1å°æ—¶çº§åˆ«ï¼‰ï¼Œä¸é€‚åˆé«˜é¢‘äº¤æ˜“åœºæ™¯ã€‚
